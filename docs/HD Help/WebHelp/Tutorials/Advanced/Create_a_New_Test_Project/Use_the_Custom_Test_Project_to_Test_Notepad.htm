<HTML>
<HEAD>
 <link rel='stylesheet' href='../../../HD_Help_2_5_ns.css'>
<script type="text/javascript" language="JavaScript" title="WebHelpSplitCss">
<!--
if (navigator.appName !="Netscape")
{   document.write("<link rel='stylesheet' href='../../../HD_Help_2_5.css'>");}
//-->
</script>
 <TITLE>Use the Custom Test Project to Test Notepad</TITLE>
 <META NAME="generator" CONTENT="RoboHelp by eHelp Corporation www.ehelp.com"><SCRIPT LANGUAGE="JavaScript" TITLE="BSSC Special Effects" SRC="../../../ehlpdhtm.js" name="EHELP_DHTM"></SCRIPT>
<script type="text/javascript" language="JavaScript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//-->
</script>
<style type="text/css">
<!--
  div.WebHelpPopupMenu {position:absolute; left:0px; top:0px; z-index:4; visibility:hidden;}
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../../whtopic.js"></script>
</HEAD>
<BODY>
 <script type="text/javascript" language="javascript1.2">
<!--
if (window.gbWhTopic)
{
	if (window.addTocInfo)
	{
	addTocInfo("Tutorials\nAdvanced\nCreate a New Test Project\nUse the Custom Test Project to Test Notepad");
addAvenueInfo("HD HELP 2_5","Tutorials/Advanced/Create_a_New_Test_Project/Create_the_Custom_Test_Project.htm","Tutorials/Advanced/Create_a_New_Test_Project/Further_Exploration_1.htm");
addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	if (window.setRelStartPage)
	{
	setRelStartPage("../../../hd_help_2_5.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();
//-->
</script>
<H1>Use the Custom Test Project to Test Notepad</H1>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P><FONT style="font-weight:bold; " >Create the interception dll</FONT></P>
 <P>Open the notepadtestdll.vcproj file from the &quot;C:\temp\Notepadtest&quot; directory. </P>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P>Open the NotepadTestdll.cpp file and find the method &quot;ReadFileReplacement.&quot; This will be called first at anytime notepad makes a call to readfile. We have the chance to add any test code we want and then pass on the parameters to the real ReadFile or just return control to notepad.</P>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P>Add the following code to the top of the ReadFileReplacement function.</P>
 <P style="margin-top:0.00pt;"><FONT style="font-family:'Courier New'; " >MessageBox(NULL, &quot;Test is about to run&quot;, &quot;&quot;, MB_OK);</FONT></P>
 <P><FONT style="font-family:'Courier New'; " >nNumberOfBytesToRead += 100;</FONT></P>
 <P>This will trick ReadFile into thinking the buffer notepad has passed it is 100 bytes larger than it really is and will force a buffer overrun. This test case will cause the application to crash, however it is not a valid test. It is rather a quick and easy demonstration to show the power of injecting your test code into the intercept-path.</P>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P>Build the notepadTestdll project by clicking Build &gt; &quot;Build Solution&quot;</P>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P><FONT style="font-weight:bold; " >Launch Notepad</FONT></P>
 <P>Open the notepadtest.vcproj file from C:\temp\notepadtest, compile the project and run it. Click Build &gt; &quot;Build Solution&quot; this will create the application to launch. Run the application by clicking Debug &gt; &quot;Start&quot; or by pressing f5. Once the application has launched the call to LaunchApplication will start notepad.</P>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P>Once Notepad has finished loading, make a call to the library we have chosen to intercept. Click File &gt; Open on the menu in Notepad, notice your dialog is displayed because notepad has made a call to the ReadFile function which we are intercepting. After you click OK to the dialog the forced buffer overrun test will execute and Notepad will crash immediately. </P>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P><IMG src="../../../images/ebx_-2117031087.gif" border=0 height=246 width=309 alt="images\ebx_-2117031087.gif"></P>
 <P style="margin-top:0;margin-bottom:0">&nbsp;</P>
 <P><A href="Create_the_Custom_Test_Project.htm">&lt;&lt; Previous</A>    <A href="Further_Exploration_1.htm">Next &gt;&gt;</A> </P>
<script type="text/javascript" language="javascript1.2">
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);
//-->
</script>
</BODY>
</HTML>